effort = sum(effort)) %>%
mutate(proportion = success/(success+failures))
View(props)
props.long <- gather(props, outcome, number, success:failures, factor_key = TRUE)
ggplot(data = props.long, aes(x = YEAR, y = number)) + geom_bar(aes(fill = outcome), position = "dodge",
stat = "identity")
ggplot(data = props.long, aes(x = YEAR, y = number)) + geom_bar(aes(fill = outcome), position = "dodge",
stat = "identity") +
xlab("Year") + ylab("Number of grids") +
labs(title = "eBird checklists with and without FOSP",
subtitle = "northern and western counties of Maine & NH")
y <- cbind(props$success,props$failures)
FOSP.m1 <- glm(y ~ props$YEAR + props$effort, family = binomial)
summary(FOSP.m1)
FOSP.m2 <- glm(y ~ props$YEAR, family = binomial)
summary(FOSP.m2)
anova(FOSP.m1,FOSP.m2)
mod.comp <- anova(FOSP.m1,FOSP.m2)
summary(mod.comp)
anova(FOSP.m1,FOSP.m2)
FOSP.m3 <- glm(y ~ 1, family = binomial)
anova(FOSP.m1,FOSP.m2, FOSP.m3)
anova(FOSP.m3,FOSP.m2, FOSP.m1)
anova(FOSP.m3,FOSP.m2, FOSP.m1, test = "Chisq")
anova(FOSP.m2, FOSP.m1, test = "Chisq")
anova(FOSP.m1, FOSP.m2, test = "Chisq")
xyear <- seq(from = 2003, to = 2016, by = 1)
newdata <- data.frame(YEAR = seq(from = 1998, to = 2016, by = 1), effort = rep(1000,19))
yvals <- predict(FOSP.m2, newdata = newdata, type = "response",se.fit = TRUE)
newdata <- data.frame(YEAR = seq(from = 2003, to = 2016, by = 1), effort = rep(1000,19))
newdata <- data.frame(YEAR = seq(from = 2003, to = 2016, by = 1), effort = rep(1000,14))
yvals <- predict(FOSP.m2, newdata = newdata, type = "response",se.fit = TRUE)
y
props <- uniqueChecklistsGridded %>%
filter(COUNTRY == "United States") %>%
filter(YEAR > 2002) %>%
group_by(YEAR,grid.id) %>%
summarize(FOSPp = max(FOSPp), effort = sum(EFFORT_HRS)) %>%
group_by(YEAR, FOSPp) %>%
summarize(n = n_distinct(grid.id), effort = sum(effort))
props <- props %>%
mutate(success = ifelse(FOSPp == 1,n,0))
props <- props %>%
mutate(failures = ifelse(FOSPp == 0,n,0))
props <- props %>%
group_by(YEAR) %>%
summarize(success = max(success), failures = max(failures),
effort = sum(effort)) %>%
mutate(proportion = success/(success+failures))
#Make a long version for plotting in ggplot
props.long <- gather(props, outcome, number, success:failures, factor_key = TRUE)
ggplot(data = props.long, aes(x = YEAR, y = number)) + geom_bar(aes(fill = outcome), position = "dodge",
stat = "identity") +
xlab("Year") + ylab("Number of grids") +
labs(title = "eBird checklists with and without FOSP",
subtitle = "northern and western counties of Maine & NH")
y <- cbind(props$success,props$failures)
FOSP.m1 <- glm(y ~ props$YEAR + props$effort, family = binomial)
summary(FOSP.m1)
FOSP.m2 <- glm(y ~ props$YEAR, family = binomial)
summary(FOSP.m2)
anova(FOSP.m1, FOSP.m2, test = "Chisq")
newdata <- data.frame(YEAR = seq(from = 2003, to = 2016, by = 1), effort = rep(1000,14))
yvals <- predict(FOSP.m2, newdata = newdata, type = "response",se.fit = TRUE)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow",
pch = 16, col = "blue", lwd = 2)
lines(newdata$YEAR, yvals$fit, col = "red", lwd = 2)
yvals$upperci <- yvals$fit + yvals$se.fit*yvals$fit
yvals$lowerci <- yvals$fit - yvals$se.fit*yvals$fit
lines(newdata$YEAR, yvals$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvals$upperci, col = "red", lwd = 2, lty = 3)
View(y)
library(effects)
install.packages("effects")
library(effects)
effect(term = "YEAR", mod = FOSP.m2, xlevels = 13)
effect(mod = FOSP.m2)
Effect(mod = FOSP.m2)
Effect(focal.predictors = "YEAR", mod = FOSP.m2)
View(newdata)
yvals$upperci <- yvals$fit + yvals$se.fit*2
yvals$lowerci <- yvals$fit - yvals$se.fit*2
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow",
pch = 16, col = "blue", lwd = 2)
lines(newdata$YEAR, yvals$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvals$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvals$upperci, col = "red", lwd = 2, lty = 3)
install.packages(c("data.table", "dplyr", "tidyr", "sp", "ggplot2", "rgeos", "maptools", "raster", "maps", "rgdal"))
summary(FOSP.m1)
summary(FOSP.m2)
anova(FOSP.m1, FOSP.m2, test = "Chisq")
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvals$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvals$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvals$upperci, col = "red", lwd = 2, lty = 3)
install.packages("effects")
library(effects)
Effect(focal.predictors = "YEAR", mod = FOSP.m2)
Effect(focal.predictors = "props$YEAR", mod = FOSP.m2)
names(FOSP.m2)
Effect(term = "props$YEAR", mod = FOSP.m2)
Effect(focal.predictors = "props$YEAR", mod = FOSP.m2)
Effect(focal.predictors == "props$YEAR", mod = FOSP.m2)
Effect(focal.predictors = c("props$YEAR"), mod = FOSP.m2)
FOSP.m2
Effect(focal.predictors = c("YEAR"), mod = FOSP.m2)
Effect(focal.predictors = c("props$YEAR"), mod = FOSP.m2)
Effect("props$YEAR", mod = FOSP.m2)
effect("props$YEAR", mod = FOSP.m2)
summary(FOSP.m2)
View(props)
View(uniqueChecklistsGridded)
# Repeat approach for BITH:
#turn this into a 2-column successes/failures frame:
propsBith <- uniqueChecklistsGridded %>%
filter(COUNTRY == "United States") %>%
filter(YEAR > 2002) %>%
group_by(YEAR,grid.id) %>%
summarize(BITHp = max(BITHp), effort = sum(EFFORT_HRS)) %>%
group_by(YEAR, BITHp) %>%
summarize(n = n_distinct(grid.id), effort = sum(effort))
propsBith <- propsBith %>%
mutate(success = ifelse(BITHp == 1,n,0))
propsBith <- propsBith %>%
mutate(failures = ifelse(BITHp == 0,n,0))
propsBith <- propsBith %>%
group_by(YEAR) %>%
summarize(success = max(success), failures = max(failures),
effort = sum(effort)) %>%
mutate(proportion = success/(success+failures))
library(dplyr)
# Repeat approach for BITH:
#turn this into a 2-column successes/failures frame:
propsBith <- uniqueChecklistsGridded %>%
filter(COUNTRY == "United States") %>%
filter(YEAR > 2002) %>%
group_by(YEAR,grid.id) %>%
summarize(BITHp = max(BITHp), effort = sum(EFFORT_HRS)) %>%
group_by(YEAR, BITHp) %>%
summarize(n = n_distinct(grid.id), effort = sum(effort))
propsBith <- propsBith %>%
mutate(success = ifelse(BITHp == 1,n,0))
propsBith <- propsBith %>%
mutate(failures = ifelse(BITHp == 0,n,0))
propsBith <- propsBith %>%
group_by(YEAR) %>%
summarize(success = max(success), failures = max(failures),
effort = sum(effort)) %>%
mutate(proportion = success/(success+failures))
#Make a long version for plotting in ggplot
propsBith.long <- gather(propsBith, outcome, number, success:failures, factor_key = TRUE)
library(tidyr)
#Make a long version for plotting in ggplot
propsBith.long <- gather(propsBith, outcome, number, success:failures, factor_key = TRUE)
ggplot(data = propsBith.long, aes(x = YEAR, y = number)) + geom_bar(aes(fill = outcome), position = "dodge",
stat = "identity") +
xlab("Year") + ylab("Number of grids") +
labs(title = "eBird checklists with and without BITH",
subtitle = "northern and western counties of Maine & NH")
library(ggplot2)
ggplot(data = propsBith.long, aes(x = YEAR, y = number)) + geom_bar(aes(fill = outcome), position = "dodge",
stat = "identity") +
xlab("Year") + ylab("Number of grids") +
labs(title = "eBird checklists with and without BITH",
subtitle = "northern and western counties of Maine & NH")
#Model incidence ~ time
yB <- cbind(props$success,props$failures)
BITH.m1 <- glm(yB ~ props$YEAR + props$effort, family = binomial)
summary(BITH.m1)
BITH.m2 <- glm(yB ~ props$YEAR, family = binomial)
summary(BITH.m2)
#Model incidence ~ time
yB <- cbind(propsBith$success,propsBith$failures)
BITH.m1 <- glm(yB ~ propsBith$YEAR + propsBith$effort, family = binomial)
summary(BITH.m1)
BITH.m2 <- glm(yB ~ propsBith$YEAR, family = binomial)
summary(BITH.m2)
# The best model is the simpler model, with an effect of Year only:
anova(BITH.m1, BITH.m2, test = "Chisq")
yvalsBith <- predict(BITH.m2, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBith$upperci <- yvalsBith$fit + yvalsBith$se.fit*2
yvalsBith$lowerci <- yvalsBith$fit - yvalsBith$se.fit*2
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Bicknell's Thrush",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBith$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBith$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBith$upperci, col = "red", lwd = 2, lty = 3)
plot(x = newdata$YEAR, y = propsBith$proportion, ylab = "Proportion of checklists reporting Bicknell's Thrush",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBith$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBith$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBith$upperci, col = "red", lwd = 2, lty = 3)
# and for BLPW:
#turn this into a 2-column successes/failures frame:
propsBlpw <- uniqueChecklistsGridded %>%
filter(COUNTRY == "United States") %>%
filter(YEAR > 2002) %>%
group_by(YEAR,grid.id) %>%
summarize(BLPWp = max(BLPWp), effort = sum(EFFORT_HRS)) %>%
group_by(YEAR, BLPWp) %>%
summarize(n = n_distinct(grid.id), effort = sum(effort))
propsBlpw <- propsBlpw %>%
mutate(success = ifelse(BLPWp == 1,n,0))
propsBlpw<- propsBlpw %>%
mutate(failures = ifelse(BLPWp == 0,n,0))
propsBlpw <- propsBlpw %>%
group_by(YEAR) %>%
summarize(success = max(success), failures = max(failures),
effort = sum(effort)) %>%
mutate(proportion = success/(success+failures))
#Make a long version for plotting in ggplot
propsBlpw.long <- gather(propsBlpw, outcome, number, success:failures, factor_key = TRUE)
ggplot(data = propsBlpw.long, aes(x = YEAR, y = number)) + geom_bar(aes(fill = outcome), position = "dodge",
stat = "identity") +
xlab("Year") + ylab("Number of grids") +
labs(title = "eBird checklists with and without BLPW",
subtitle = "northern and western counties of Maine & NH")
#Model incidence ~ time
yBl <- cbind(propsBlpw$success,propsBlpw$failures)
BLPW.m1 <- glm(yBl ~ propsBlpw$YEAR + propsBith$effort, family = binomial)
summary(BLPW.m1)
BLPW.m2 <- glm(yBl ~ propsBlpw$YEAR, family = binomial)
summary(BLPW.m2)
# The best model is the simpler model, with an effect of Year only:
anova(BLPW.m1, BLPW.m2, test = "Chisq")
# predict values of y from xv and m2
yvalsBlpw <- predict(BITH.m1, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists reporting Blackpoll Warbler",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
valsBlpw$lowerci
yvalsBlpw$lowerci
yvalsBlpw$upperci
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m2, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists reporting Blackpoll Warbler",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$YEAR^2 + propsBith$effort, family = binomial)
summary(BLPW.m3)
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR + (propsBlpw$YEAR)^2 + propsBith$effort, family = binomial)
summary(BLPW.m3)
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR + (propsBlpw$YEAR*probsBlpw$YEAR) + propsBith$effort, family = binomial)
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR + (propsBlpw$YEAR*propsBlpw$YEAR) + propsBith$effort, family = binomial)
summary(BLPW.m3)
View(propsBlpw)
propsBlpw$YEAR2 <- propsBlpw^2
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$YEAR2 + propsBith$effort, family = binomial)
summary(BLPW.m3)
View(propsBlpw)
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$YEAR2 + propsBlpw$effort, family = binomial)
summary(BLPW.m3)
BLPW.m1 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$effort, family = binomial)
summary(BLPW.m1)
BLPW.m2 <- glm(yBl ~ propsBlpw$YEAR, family = binomial)
summary(BLPW.m2)
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$YEAR2 + propsBlpw$effort, family = binomial)
summary(BLPW.m3)
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR*propsBlpw$YEAR2 + propsBlpw$effort, family = binomial)
summary(BLPW.m3)
propsBlpw$YEAR2 <- NULL
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists reporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR + I(propsBlpw$YEAR^2) + propsBlpw$effort, family = binomial)
summary(BLPW.m3)
# The best model is the simpler model, with an effect of Year only:
anova(BLPW.m1, BLPW.m2, BLPW.m3 test = "Chisq")
# The best model is the simpler model, with an effect of Year only:
anova(BLPW.m1, BLPW.m2, BLPW.m3, test = "Chisq")
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists reporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
View(yvalsBlpw)
View(yvalsBlpw)
View(propsBlpw)
summary(propsBlpw)
summary(propsBith)
# predict values of y from xv and m2
newdata <- data.frame(YEAR = seq(from = 2003, to = 2016, by = 1), effort = rep(1190,14))
yvals <- predict(FOSP.m2, newdata = newdata, type = "response",se.fit = TRUE)
yvals$upperci <- yvals$fit + yvals$se.fit*2
yvals$lowerci <- yvals$fit - yvals$se.fit*2
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvals$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvals$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvals$upperci, col = "red", lwd = 2, lty = 3)
yvalsBith <- predict(BITH.m2, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBith$upperci <- yvalsBith$fit + yvalsBith$se.fit*2
yvalsBith$lowerci <- yvalsBith$fit - yvalsBith$se.fit*2
plot(x = newdata$YEAR, y = propsBith$proportion, ylab = "Proportion of checklists reporting Bicknell's Thrush",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBith$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBith$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBith$upperci, col = "red", lwd = 2, lty = 3)
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists reporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
par()
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2,
par(5,3,4,2))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2,
par(mar = c(5,3,4,2)))
opar <- par()
par(mar = c(5.1,3.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
par(opar)
opar <- par()
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBith$proportion, ylab = "Proportion of checklists\nreporting Bicknell's Thrush",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBith$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBith$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBith$upperci, col = "red", lwd = 2, lty = 3)
par(opar)
opar <- par()
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvals$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvals$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvals$upperci, col = "red", lwd = 2, lty = 3)
par(opar)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
plot(x = newdata$YEAR, y = propsBith$proportion,
pch = 16, col = "black", lwd = 2)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
plot(x = newdata$YEAR, y = propsBith$proportion,
pch = 16, col = "black", lwd = 2,
add = T)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting\nFox Sparrow,
Bicknell's Thrush, or Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting\nFox Sparrow,Bicknell's Thrush, or Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow,\nBicknell's Thrush, or Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow,\nBicknell's Thrush, or Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2,
xmin = 0, xmax = 0.45)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow,\nBicknell's Thrush, or Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2,
ylim = c(0,0.45))
points(y = propsBith$proportion, add = T)
points(x = newdata$YEAR,y = propsBith$proportion, add = T)
points(x = newdata$YEAR, y = propsBlpw$proportion, add = T, color = "black")
points(x = newdata$YEAR, y = propsBlpw$proportion, add = T, color = "red")
points(x = newdata$YEAR, y = propsBlpw$proportion, add = T, col = "black")
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow,\nBicknell's Thrush, or Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2,
ylim = c(0,0.45))
points(x = newdata$YEAR,y = propsBith$proportion, add = T)
points(x = newdata$YEAR, y = propsBlpw$proportion, col = "red",add = T)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow,\nBicknell's Thrush, or Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2,
ylim = c(0,0.45))
points(x = newdata$YEAR,y = propsBith$proportion, add = T)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow,\nBicknell's Thrush, or Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2,
ylim = c(0,0.45))
points(x = newdata$YEAR,y = propsBith$proportion)
points(x = newdata$YEAR, y = propsBlpw$proportion, col = "red")
lines(newdata$YEAR, yvals$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvals$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvals$upperci, col = "red", lwd = 2, lty = 3)
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists reporting Fox Sparrow,\nBicknell's Thrush, or Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2,
ylim = c(0,0.45))
points(x = newdata$YEAR,y = propsBith$proportion)
points(x = newdata$YEAR, y = propsBlpw$proportion, col = "red")
lines(newdata$YEAR, yvals$fit, col = "blue", lwd = 2)
lines(newdata$YEAR, yvals$lowerci, col = "blue", lwd = 2, lty = 3)
lines(newdata$YEAR, yvals$upperci, col = "blue", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBith$fit, col = "black", lwd = 2)
lines(newdata$YEAR, yvalsBith$lowerci, col = "black", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBith$upperci, col = "black", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
round()
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- round(yvalsBlpw$fit + yvalsBlpw$se.fit*2,2)
yvalsBlpw$lowerci <- round(yvalsBlpw$fit - yvalsBlpw$se.fit*2,2)
opar <- par()
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
par(opar)
View(yvalsBlpw)
View(yvalsBlpw)
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- round(yvalsBlpw$fit + yvalsBlpw$se.fit*2)
yvalsBlpw$lowerci <- round(yvalsBlpw$fit - yvalsBlpw$se.fit*2)
BLPW.m3 <- glm(yBl ~ poly(propsBlpw$YEAR,2) + propsBlpw$effort, family = binomial)
summary(BLPW.m3)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- round(yvalsBlpw$fit + yvalsBlpw$se.fit*2)
yvalsBlpw$lowerci <- round(yvalsBlpw$fit - yvalsBlpw$se.fit*2)
opar <- par()
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
View(yvalsBlpw)
dev.off()
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
View(yvalsBlpw)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
par(opar)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
yvalsBlpw$upperci
yvalsBlpw$lowerci
View(yvalsBlpw)
View(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
rm(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
yvalsBlpw$upperci <- round(yvalsBlpw$fit + yvalsBlpw$se.fit*2)
yvalsBlpw$lowerci <- round(yvalsBlpw$fit - yvalsBlpw$se.fit*2)
View(yvalsBlpw)
