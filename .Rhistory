pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
View(yvalsBlpw)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
par(opar)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
yvalsBlpw$upperci
yvalsBlpw$lowerci
View(yvalsBlpw)
View(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
rm(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
yvalsBlpw$upperci <- round(yvalsBlpw$fit + yvalsBlpw$se.fit*2)
yvalsBlpw$lowerci <- round(yvalsBlpw$fit - yvalsBlpw$se.fit*2)
View(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
yvalsBlpw$upperci <- round(yvalsBlpw$fit + yvalsBlpw$se.fit*2)
yvalsBlpw$lowerci <- round(yvalsBlpw$fit - yvalsBlpw$se.fit*2)
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
View(yvalsBlpw)
rm(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
View(yvalsBlpw)
par(mar = c(5.1,5.1,4.1,2.1))
par(mfrow = c(3,1))
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvals$fit, col = "blue", lwd = 2)
lines(newdata$YEAR, yvals$lowerci, col = "blue", lwd = 2, lty = 3)
lines(newdata$YEAR, yvals$upperci, col = "blue", lwd = 2, lty = 3)
### Bicknell's Thrush:
plot(x = newdata$YEAR, y = propsBith$proportion, ylab = "Proportion of checklists\nreporting Bicknell's Thrush",
xlab = "Year",
pch = 16, col = "red", lwd = 2)
#### add the fitted line
lines(newdata$YEAR, yvalsBith$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBith$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBith$upperci, col = "red", lwd = 2, lty = 3)
### Blackpoll Warbler
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
##### add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
par(mar = c(5.1,5.1,4.1,2.1))
par(mfrow = c(3,1))
plot(x = newdata$YEAR, y = props$proportion, ylab = "Proportion of checklists\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvals$fit, col = "blue", lwd = 2)
lines(newdata$YEAR, yvals$lowerci, col = "blue", lwd = 2, lty = 3)
lines(newdata$YEAR, yvals$upperci, col = "blue", lwd = 2, lty = 3)
### Bicknell's Thrush:
plot(x = newdata$YEAR, y = propsBith$proportion, ylab = "Proportion of checklists\nreporting Bicknell's Thrush",
xlab = "Year",
pch = 16, col = "red", lwd = 2)
#### add the fitted line
lines(newdata$YEAR, yvalsBith$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBith$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBith$upperci, col = "red", lwd = 2, lty = 3)
### Blackpoll Warbler
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "black", lwd = 2)
##### add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "black", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "black", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "black", lwd = 2, lty = 3)
summary(BLPW.m3)
summary(BLPW.m2)
17.6/12
summary(BITH.m2)
pchisq(summary(BITH.m1)$dispersion * BITH.m1$df.residual,
BITH.m1$df.residual, lower = F)
pchisq(summary(BLPW.m1)$dispersion * BLPW.m1$df.residual,
BLPW.m1$df.residual, lower = F)
pchisq(BLPW.m1$deviance/BLPW.m1$df.residual, lower = F)
# Test for overdispersion:
FOSP.m2 <- glm(y ~ props$YEAR, family = quasibinomial)
summary(FOSP.m2)
FOSP.m2 <- glm(y ~ props$YEAR, family = binomial)
summary(FOSP.m2)
BITH.m2 <- glm(yB ~ propsBith$YEAR, family = quasibinomial)
summary(BITH.m2)
BITH.m2 <- glm(yB ~ propsBith$YEAR, family = binomial)
summary(BITH.m2)
19.698/12
# predict values of y from xv and m2
yvalsBith <- predict(BITH.m2, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBith$upperci <- yvalsBith$fit + yvalsBith$se.fit*2
yvalsBith$lowerci <- yvalsBith$fit - yvalsBith$se.fit*2
opar <- par()
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBith$proportion, ylab = "Proportion of checklists\nreporting Bicknell's Thrush",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBith$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBith$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBith$upperci, col = "red", lwd = 2, lty = 3)
dev.off()
plot(x = newdata$YEAR, y = propsBith$proportion, ylab = "Proportion of checklists\nreporting Bicknell's Thrush",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBith$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBith$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBith$upperci, col = "red", lwd = 2, lty = 3)
confint(BITH.m2)
summary(BLPW.m2)
BLPW.m1 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$effort, family = quasibinomial)
summary(BLPW.m1)
BLPW.m1 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$effort, family = binomial)
summary(BLPW.m1)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
#Model incidence ~ time
yBl <- cbind(propsBlpw$success,propsBlpw$failures)
BLPW.m1 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$effort, family = binomial)
summary(BLPW.m1)
BLPW.m2 <- glm(yBl ~ propsBlpw$YEAR, family = binomial)
summary(BLPW.m2)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
newdata
View(yvalsBlpw)
rm(vyalsBlpw)
rm(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
View(yvalsBlpw)
View(yvalsBlpw)
View(yvalsBlpw)
rm(yvalsBlpw)
summary(BLPW.m1)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
yBl <- cbind(propsBlpw$success,propsBlpw$failures)
BLPW.m1 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$effort, family = binomial)
summary(BLPW.m1)
BLPW.m2 <- glm(yBl ~ propsBlpw$YEAR, family = binomial)
summary(BLPW.m2)
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR + I(propsBlpw$YEAR^2) + propsBlpw$effort, family = binomial)
summary(BLPW.m3)
# The best model is the simpler model, with an effect of Year only:
anova(BLPW.m1, BLPW.m2, BLPW.m3, test = "Chisq")
newdata
str(newdata)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m2, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
summary(BLPW.m1)
View(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
View(yvalsBlpw)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
yvalsBlpw$fit
View(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
yBl
BLPW.m1 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$effort, family = binomial)
summary(BLPW.m1)
BLPW.m2 <- glm(yBl ~ propsBlpw$YEAR, family = binomial)
summary(BLPW.m2)
BLPW.m3 <- glm(yBl ~ propsBlpw$YEAR + I(propsBlpw$YEAR^2) + propsBlpw$effort, family = binomial)
summary(BLPW.m3)
# The best model is the simpler model, with an effect of Year only:
anova(BLPW.m1, BLPW.m2, BLPW.m3, test = "Chisq")
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
View(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "link",se.fit = TRUE)
View(yvalsBlpw)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
dev.off()
lines(newdata$YEAR, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
exp(yvalsBlpw$fit)/(1+exp(yvalsBlpw$fit))
newdata
# predict values of y from xv and m2
newdata <- data.frame(YEAR = seq(from = 2003, to = 2016, by = 1), effort = rep(1000,14))
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "link",se.fit = TRUE)
exp(yvalsBlpw$fit)/(1+exp(yvalsBlpw$fit))
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
View(yvalsBlpw)
View(yvalsBlpw)
YEAR = seq(from = 2003, to = 2016, by = 0.01)
YEAR
str(YEAR)
# predict values of y from xv and m2
newdata <- data.frame(YEAR = seq(from = 2003, to = 2016, by = 0.01), effort = rep(1000,1301))
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
BLPW.m1 <- glm(yBl ~ propsBlpw$YEAR + propsBlpw$effort, family = binomial)
summary(BLPW.m1)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m1, newdata = newdata, type = "response",se.fit = TRUE)
newdata
# predict values of y from xv and m2
newdata <- data.frame(YEAR = seq(from = 2003, to = 2016, by = 0.01), effort = rep(1000,1301))
yvals <- predict(FOSP.m2, newdata = newdata, type = "response",se.fit = TRUE)
str(newdata)
View(newdata)
y
data.frame()
FOSP.df <- data.frame(success = props$success), "failure" = props$failures,
"year" = props$YEAR, "effort" = props$effort)
FOSP.df <- data.frame(success = props$success)
View(FOSP.df)
FOSP.df <- data.frame(success = props$success, failure = props$failures,
year = props$YEAR, effort = props$effort)
FOSP.test <- glm(cbind(success,failure) ~ year + effort, family = binomial, data = FOSP.df)
summary(FOSP.test)
summary(FOSP.m1)
rm(FOSP.df)
rm(y)
FOSP.m1 <- glm(cbind(success,failure) ~ year + effort, family = binomial, data = FOSP.df)
summary(FOSP.m1)
FOSP.m2 <- glm(cbind(success,failure) ~ year, family = binomial, data = FOSP.df)
summary(FOSP.m2)
# The best model is the simpler model, with an effect of Year only:
anova(FOSP.m1, FOSP.m2, test = "Chisq")
# predict values of y from xv and m2
newdata <- data.frame(YEAR = seq(from = 2003, to = 2016, by = 0.01), effort = rep(1000,1301))
yvals <- predict(FOSP.m2, newdata = newdata, type = "response",se.fit = TRUE)
# predict values of y from xv and m2
newdata <- data.frame(year = seq(from = 2003, to = 2016, by = 0.01), effort = rep(1000,1301))
yvals <- predict(FOSP.m2, newdata = newdata, type = "response",se.fit = TRUE)
newdata
summary(FOSP.m2)
FOSP.m2 <- glm(cbind(success,failure) ~ year, family = binomial, data = FOSP.df)
summary(FOSP.m2)
FOSP.df <- data.frame(success = props$success, failure = props$failures,
year = props$YEAR, effort = props$effort)
FOSP.m1 <- glm(cbind(success,failure) ~ year + effort, family = binomial, data = FOSP.df)
summary(FOSP.m1)
FOSP.m2 <- glm(cbind(success,failure) ~ year, family = binomial, data = FOSP.df)
summary(FOSP.m2)
summary(FOSP.m2)
# predict values of y from xv and m2
newdata <- data.frame(year = seq(from = 2003, to = 2016, by = 0.01), effort = rep(1000,1301))
yvals <- predict(FOSP.m2, newdata = newdata, type = "response",se.fit = TRUE)
yvals$upperci <- yvals$fit + yvals$se.fit*2
yvals$lowerci <- yvals$fit - yvals$se.fit*2
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$year, y = props$proportion, ylab = "Proportion of checklists\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
plot(x = props$year, y = props$proportion, ylab = "Proportion of checklists\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
View(props)
plot(x = props$YEAR, y = props$proportion, ylab = "Proportion of checklists\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$YEAR, yvals$fit, col = "red", lwd = 2)
lines(newdata$YEAR, yvals$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$YEAR, yvals$upperci, col = "red", lwd = 2, lty = 3)
# add the fitted line
lines(newdata$year, yvals$fit, col = "red", lwd = 2)
lines(newdata$year, yvals$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$year, yvals$upperci, col = "red", lwd = 2, lty = 3)
BITH.df <- data.frame(success = propsBith$success, failure = propsBith$failures,
year = propsBith$YEAR, effort = propsBith$effort)
BITH.m1 <- glm(cbind(success,failure) ~ year + effort, family = binomial, data = BITH.df)
summary(BITH.m1)
BITH.m2 <- glm(cbind(success,failure) ~ year, family = binomial, data = BITH.df)
summary(BITH.m2)
BITH.m2OD <- glm(cbind(success,failure) ~ year, family = quasibinomial, data = BITH.df)
summary(BITH.m2OD)
# predict values of y from xv and m2
yvalsBith <- predict(BITH.m2OD, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBith$upperci <- yvalsBith$fit + yvalsBith$se.fit*2
yvalsBith$lowerci <- yvalsBith$fit - yvalsBith$se.fit*2
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = propsBith$YEAR, y = propsBith$proportion, ylab = "Proportion of checklists\nreporting Bicknell's Thrush",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$year, yvalsBith$fit, col = "red", lwd = 2)
lines(newdata$year, yvalsBith$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$year, yvalsBith$upperci, col = "red", lwd = 2, lty = 3)
BLPW.df <- data.frame(success = propsBlpw$success, failure = propsBlpw$failures,
year = propsBlpw$YEAR, effort = propsBlpw$effort)
BLPW.m1 <- glm(cbind(success,failure) ~ year + effort, family = binomial, data = BLPW.df)
summary(BLPW.m1)
BLPW.m2 <- glm(cbind(success,failure) ~ year, family = binomial, data = BLPW.df)
summary(BLPW.m2)
BLPW.m3 <- glm(cbind(success,failure) ~ year + I(year^2) + effort, family = binomial, data = BLPW.df)
summary(BLPW.m3)
# The best model is the simpler model, with an effect of Year only:
anova(BLPW.m1, BLPW.m2, BLPW.m3, test = "Chisq")
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m3, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = newdata$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
plot(x = propsBlpw$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$year, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$year, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$year, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
View(yvalsBlpw)
# predict values of y from xv and m2
yvalsBlpw <- predict(BLPW.m2, newdata = newdata, type = "response",se.fit = TRUE)
yvalsBlpw$upperci <- yvalsBlpw$fit + yvalsBlpw$se.fit*2
yvalsBlpw$lowerci <- yvalsBlpw$fit - yvalsBlpw$se.fit*2
par(mar = c(5.1,5.1,4.1,2.1))
plot(x = propsBlpw$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$year, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$year, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$year, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
par(mar = c(5.1,5.1,4.1,2.1))
par(mfrow = c(2,2))
plot(x = props$YEAR, y = props$proportion, ylab = "Proportion of checklists\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$year, yvals$fit, col = "red", lwd = 2)
lines(newdata$year, yvals$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$year, yvals$upperci, col = "red", lwd = 2, lty = 3)
### Bicknell's Thrush:
plot(x = propsBith$YEAR, y = propsBith$proportion, ylab = "Proportion of checklists\nreporting Bicknell's Thrush",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$year, yvalsBith$fit, col = "red", lwd = 2)
lines(newdata$year, yvalsBith$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$year, yvalsBith$upperci, col = "red", lwd = 2, lty = 3)
### Blackpoll Warbler
plot(x = propsBlpw$YEAR, y = propsBlpw$proportion, ylab = "Proportion of checklists\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$year, yvalsBlpw$fit, col = "red", lwd = 2)
lines(newdata$year, yvalsBlpw$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$year, yvalsBlpw$upperci, col = "red", lwd = 2, lty = 3)
par(mar = c(5.1,5.1,4.1,2.1))
par(mfrow = c(2,2))
plot(x = props$YEAR, y = props$proportion, ylab = "Proportion of cells\nreporting Fox Sparrow",
xlab = "Year",
pch = 16, col = "red", lwd = 2)
# add the fitted line
lines(newdata$year, yvals$fit, col = "red", lwd = 2)
lines(newdata$year, yvals$lowerci, col = "red", lwd = 2, lty = 3)
lines(newdata$year, yvals$upperci, col = "red", lwd = 2, lty = 3)
### Bicknell's Thrush:
plot(x = propsBith$YEAR, y = propsBith$proportion, ylab = "Proportion of cells\nreporting Bicknell's Thrush",
xlab = "Year",
pch = 16, col = "blue", lwd = 2)
# add the fitted line
lines(newdata$year, yvalsBith$fit, col = "blue", lwd = 2)
lines(newdata$year, yvalsBith$lowerci, col = "blue", lwd = 2, lty = 3)
lines(newdata$year, yvalsBith$upperci, col = "blue", lwd = 2, lty = 3)
### Blackpoll Warbler
plot(x = propsBlpw$YEAR, y = propsBlpw$proportion, ylab = "Proportion of cells\nreporting Blackpoll Warbler",
xlab = "Year",
pch = 16, col = "black", lwd = 2)
# add the fitted line
lines(newdata$year, yvalsBlpw$fit, col = "black", lwd = 2)
lines(newdata$year, yvalsBlpw$lowerci, col = "black", lwd = 2, lty = 3)
lines(newdata$year, yvalsBlpw$upperci, col = "black", lwd = 2, lty = 3)
confint(FOSP.m1)
confint(FOSP.m2)
coef(FOSP.m2)
exp(0.097)/(1+exp(0.097))
View(yvals)
View(yvals)
predict(FOSP.m1,newdata = data.frame(year = 2003),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2003),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2004),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2005),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2005),type = "response")/0.00963655
0.00963655/0.0115372
predict(FOSP.m2,newdata = data.frame(year = 2003),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2004),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2005),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2006),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2007),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2008),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2009),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2010),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2011),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2012),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2013),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2014),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2015),type = "response")
predict(FOSP.m2,newdata = data.frame(year = 2016),type = "response")
confint(FOSP.m2)
coef(FOSP.m2)
coef(BITH.m2)
confint(BITH.m2)
coef(BLPW.m1)
confint(BLPW.m1)
predict(BLPW.m1,newdata = data.frame(year = 2016, effort = 1000))
predict(BLPW.m1,newdata = data.frame(year = 2016, effort = 1000), type = "response")
predict(BLPW.m1,newdata = data.frame(year = 2015, effort = 1000), type = "response")
predict(BLPW.m1,newdata = data.frame(year = 2003, effort = 1000), type = "response")
0.102776/0.4245277
0.42/0.10
0.42*0.8
0.42*0.2
0.14^14
